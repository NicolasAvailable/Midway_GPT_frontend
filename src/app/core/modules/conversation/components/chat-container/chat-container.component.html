<section class="flex w-full h-full">
  <div class="chat__container--left w-full h-full flex flex-col">
    <div #header class="chat__header">
      <mw-chat-header
        [room]="room"
        [isOpenDetails]="isOpenDetails"
        (detailTrigger)="isOpenDetails = $event"
      ></mw-chat-header>
    </div>
    <div
      autoScroll
      class="chat__content flex flex-col overflow-auto justify-center items-center w-full h-full"
    >
      @if (!this.messageStore.get().isLoading()) {
      <div class="flex flex-col w-full md:w-1/2 h-full p-2">
        @for (message of this.messageStore.get().messageList().values; track
        $index) { @if (message.role === 'assistant') {
        <div class="chat chat-start">
          <div class="chat-image avatar">
            <mw-avatar size="small" [url]="room.image"></mw-avatar>
          </div>
          <div
            class="chat-bubble min-h-3"
            [ngClass]="{ 'chat__bubble--error': message.hasError }"
          >
            <p class="text-sm" [innerHTML]="message.content"></p>
          </div>
          <div class="chat-footer opacity-50">
            <time class="text-xs opacity-50">12:45</time>
          </div>
        </div>
        } @else {
        <div class="chat chat-end">
          <div class="chat-image avatar">
            <mw-avatar size="small" [name]="profile().name"></mw-avatar>
          </div>
          <div class="chat-bubble min-h-3">
            <p class="text-sm" [innerHTML]="message.content"></p>
          </div>
          <div class="chat-footer opacity-50">
            <time class="text-xs opacity-50">12:46</time>
          </div>
        </div>
        } }
      </div>
      } @else {
      <div class="chat chat-start">
        <div class="chat-bubble min-h-3">
          <span class="loading loading-dots loading-sm"></span>
        </div>
      </div>
      }
    </div>
    <div class="chat__footer">
      <mw-chat-sender
        [roomId]="this.messageStore.get().isLoading() ? '' : room?.id"
      ></mw-chat-sender>
    </div>
  </div>
  <div
    class="chat__container--right"
    [excludeElement]="header"
    [ngClass]="{ 'chat__container--right--open': isOpenDetails }"
    (clickOutside)="isOpenDetails = false"
  >
    <mw-chat-detailer
      [room]="room"
      (detailTrigger)="isOpenDetails = false"
    ></mw-chat-detailer>
  </div>
</section>

@if (isOpenDetails) {
<div class="chat__overlay" (click)="isOpenDetails = false"></div>

}
